(in-package :epapi)

(defconstant +words-from-cold-mountain+
  "Don’t you know the poems of Han-shan?
They’re better for you than scripture-reading.
Cut them out and paste them on a screen,
Then you can gaze at them from time to time.

A thousand clouds, ten thousand streams,
Here I live, an idle man,
Roaming green peaks by day,
Back to sleep by cliffs at night.
One by one, springs and autumns go,
Free of heat and dust, my mind.
Sweet to know there’s nothing I need,
Silent as the autumn river’s flood.

Han-shan has his critics too:
‘Your poems, there’s nothing in them!’
I think of men of ancient times,
Poor, humble, but not ashamed.
Let him laugh at me and say:
‘It’s all foolishness, your work!’
Let him go on as he is,
All his life lost making money.

Where’s the trail to Cold Mountain?
Cold Mountain? There’s no clear way.
Ice, in summer, is still frozen.
Bright sun shines through thick fog.
You won’t get there following me.
Your heart and mine are not the same.
If your heart was like mine,
You’d have made it, and be there!

Cold Mountain’s full of strange sights
Men who go there end by being scared.
Water glints and gleams in the moon,
Grasses sigh and sing in the wind.
The bare plum blooms again with snow,
Naked branches have clouds for leaves.
When it rains, the mountain shines –
In bad weather you’ll not make this climb.

A thousand clouds, ten thousand streams,
Here I live, an idle man,
Roaming green peaks by day,
Back to sleep by cliffs at night.
One by one, springs and autumns go,
Free of heat and dust, my mind.
Sweet to know there’s nothing I need,
Silent as the autumn river’s flood.

High, high, the summit peak,
Boundless the world to sight!
No one knows I am here,
Lone moon in the freezing stream.
In the stream, where’s the moon?
The moon’s always in the sky.
I write this poem: and yet,
In this poem there is no Zen.

Thirty years in this world
I wandered ten thousand miles,
By rivers, buried deep in grass,
In borderlands, where red dust flies.
Tasted drugs, still not Immortal,
Read books, wrote histories.
Now I’m back at Cold Mountain,
Head in the stream, cleanse my ears.

Bird-song drowns me in feeling.
Back to my shack of straw to sleep.
Cherry-branches burn with crimson flower,
Willow-boughs delicately trail.
Morning sun flares between blue peaks,
Bright clouds soak in green ponds.
Who guessed I’d leave that dusty world,
Climbing the south slope of Cold Mountain?

I travelled to Cold Mountain:
Stayed here for thirty years.
Yesterday looked for family and friends.
More than half had gone to Yellow Springs.
Slow-burning, life dies like a flame,
Never resting, passes like a river.
Today I face my lone shadow.
Suddenly, the tears flow down.

Alive in the mountains, not at rest,
My mind cries for passing years.
Gathering herbs to find long life,
Still I’ve not achieved Immortal.
My field’s deep, and veiled in cloud,
But the wood’s bright, the moon’s full.
Why am I here? Can’t I go?
Heart still tied to enchanted pines!

If there’s something good, delight!
Seize the moment while it flies!
Though life can last a hundred years,
Who’s seen their thirty thousand days?
Just an instant then you’re gone.
Why sit whining over things?
When you’ve read the Classics through,
You’ll know quite enough of death.

The peach petals would like to stay,
But moon and wind blow them on.
You won’t find those ancient men,
Those dynasties are dead and gone.
Day by day the blossoms fall,
Year by year the people go.
Where the dust blows through these heights,
There once shone a silent sea.

Men who see the Master
Of Cold Mountain, say he’s mad.
A nothing face,
Body clothed in rags.
Who dare say what he says?
When he speaks we can’t understand.
Just one word to you who pass –
Take the trail to Cold Mountain!

Han-shan has his critics too:
‘Your poems, there’s nothing in them!’
I think of men of ancient times,
Poor, humble, but not ashamed.
Let him laugh at me and say:
‘It’s all foolishness, your work!’
Let him go on as he is,
All his life lost making money.

Cold Mountain holds a naked bug,
Its body’s white, its head is black.
In its hands a pair of scrolls,
One the Way and one its Power.
It needs no pots or stove.
Without clothes it wanders on,
But it carries Wisdom’s blade,
To cut down mindless craving.

I’m on the trail to Cold Mountain.
Cold Mountain trail never ends.
Long clefts thick with rock and stones,
Wide streams buried in dense grass.
Slippery moss, but there’s been no rain,
Pine trees sigh, but there’s no wind.
Who can leap the world’s net,
Sit here in the white clouds with me?

Men ask the way through the clouds,
The cloud way’s dark, without a sign.
High summits are of naked rock.
In deep valleys sun never shines.
Behind you green peaks, and in front,
To east the white clouds, and to west –
Want to know where the cloud way lies?
It’s there, in the centre of the Void!

Sitting alone by folded rocks,
Mist swirling even at noon,
Here, inside my room, it’s dark.
Mind is bright, clear of sound.
Through the shining gate in dream.
Back by the stone bridge, mind returns.
Where now the things that troubled me?
Wind-blown gourd rattling in the tree.

Far-off is the place I chose to live.
High hills make for silent tongues.
Gibbons screech in valley cold
My gate of grass blends with the cliff.
A roof of thatch among the pines,
I dig a pool, feed it from the stream.
No time now to think about the world,
The years go by, shredding ferns.

Level after level, falls and hills,
Blue-green mist clasped by clouds.
Fog wets my flimsy cap,
Dew soaks my coat of straw.
A pilgrim’s sandals on my feet,
An old stick grasped in my hand.
Gazing down towards the land of dust,
What is that world of dreams to me?

What a road the Cold Mountain road!
Not a sign of horse or cart.
Winding gorges, tricky to trace.
Massive cliffs, who knows how high?
Where the thousand grasses drip with dew,
Where the pine trees hum in the wind.
Now the path’s lost, now it’s time
For body to ask shadow: ‘Which way home?’

Always it’s cold on this mountain!
Every year, and not just this.
Dense peaks, thick with snow.
Black pine-trees breathing mist.
It’s summer before the grass grows,
Not yet autumn when the leaves fall.
Full of illusions, I roam here,
Gaze and gaze, but can’t see the sky.

No knowing how far it is,
This place where I spend my days.
Tangled vines move without a breeze,
Bamboo in the light shows dark.
Streams down-valley sob for whom?
Mists cling together, who knows why?
Sitting in my hut at noon,
Suddenly, I see the sun has risen.

The everyday mind: that is the way.
Buried in vines and rock-bound caves,
Here it’s wild, here I am free,
Idling with the white clouds, my friends.
Tracks here never reach the world;
No-mind, so what can shift my thought?
I sit the night through on a bed of stone,
While the moon climbs Cold Mountain.

I was off to the Eastern Cliff.
Planned that trip for how long?
Dragged myself up by hanging vines,
Stopped halfway, by wind and fog.
Thorn snatched my arm on narrow tracks,
Moss so deep it drowned my feet,
So I stopped, under this red pine.
Head among the clouds, I’ll sleep.

Bright water shimmers like crystal,
Translucent to the furthest depth.
Mind is free of every thought
Unmoved by the myriad things.
Since it can never be stirred
It will always stay like this.
Knowing, this way, you can see,
There is no within, no without.

Are you looking for a place to rest?
Cold Mountain’s good for many a day.
Wind sings here in the black pines,
Closer you are, the better it sounds.
There’s an old man sitting by a tree,
Muttering about the things of Tao.
Ten years now, it’s been so long
This one’s forgotten his way home.

Cold rock, no one takes this road.
The deeper you go, the finer it is.
White clouds hang on high crags.
On Green Peak a lone gibbon’s cry.
What friends do I need?
I do what pleases me, and grow old.
Let face and body alter with the years,
I’ll hold to the bright path of mind.")

(defun verses (poem)
  (split (format nil "~%~%") poem))

(start-display)
(initialize-blank-display)
(slowly-clear)
(refresh)

(defconstant +puti-puti+
  "Pūti, pūti ziemelīti
Ziemassvētku vakarāi
Lai tie pūti rudzus, miežus
Stallī bērus kumeliņus")

(defun live-poetry (x y text)
  (progn
    (with-packed-writes t
      (with-live-update t
        (time-poem x y text)))))

(defun cold-mountain ()
  (start-display)
  (initialize-blank-display)
  (with-font :concrete-roman 64
    (unwind-protect
         (progn
           (with-font :concrete-roman 92
             (live-poetry 400 520
                          "Words from Cold Mountain"))
           (with-font :concrete-roman 64
             (live-poetry 460 640
                          "Twenty-Seven Poems by Han-Shan"))
           (initialize-blank-display)
           (loop for verse in (subseq (verses +words-from-cold-mountain+) 0 2)
                 with i = 1
                 do (progn
                      (with-font :concrete-roman 92
                        (live-poetry 200 150 (format nil "~@r" i)))
                      (sleep 2)
                      (live-poetry 200 300 verse)
                      (incf i)
                      (initialize-blank-display))))
      (goodnight))))

(zpng:write-png (canvas-to-png *local-framebuffer*) "frame.png")

(defun goodnight ()
  (initialize-blank-display)
  (enter-sleep-mode))

(goodnight)
